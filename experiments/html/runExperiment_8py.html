<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MopatopExperiments: runExperiment.py File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MopatopExperiments
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">runExperiment.py File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Use csv files to define sets of values to be used in an experiment.  
<a href="#details">More...</a></p>

<p><a href="runExperiment_8py_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad8918e03878b1f3c373ab776b2e22605"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#ad8918e03878b1f3c373ab776b2e22605">change</a> (old, new)</td></tr>
<tr class="separator:ad8918e03878b1f3c373ab776b2e22605"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0fce901dc647ee562ab8d0691375eb21"><td class="memItemLeft" align="right" valign="top"><a id="a0fce901dc647ee562ab8d0691375eb21"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#a0fce901dc647ee562ab8d0691375eb21">experimentName</a> = 'endTimeTest10_20000'</td></tr>
<tr class="memdesc:a0fce901dc647ee562ab8d0691375eb21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of the experiment of the experiment to run. <br /></td></tr>
<tr class="separator:a0fce901dc647ee562ab8d0691375eb21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae78b8040851170f42caea9a79d89addc"><td class="memItemLeft" align="right" valign="top"><a id="ae78b8040851170f42caea9a79d89addc"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#ae78b8040851170f42caea9a79d89addc">directRun</a> = True</td></tr>
<tr class="memdesc:ae78b8040851170f42caea9a79d89addc"><td class="mdescLeft">&#160;</td><td class="mdescRight">if set to True, run the model now! otherwise output a set of parameterFiles <br /></td></tr>
<tr class="separator:ae78b8040851170f42caea9a79d89addc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a772e2b3516805bd146ad5cfecc9bc856"><td class="memItemLeft" align="right" valign="top"><a id="a772e2b3516805bd146ad5cfecc9bc856"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#a772e2b3516805bd146ad5cfecc9bc856">execname</a> = 'agentModel'</td></tr>
<tr class="memdesc:a772e2b3516805bd146ad5cfecc9bc856"><td class="mdescLeft">&#160;</td><td class="mdescRight">needed if running the model now - the name of the executable to run assumed to live in root directory as below <br /></td></tr>
<tr class="separator:a772e2b3516805bd146ad5cfecc9bc856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeabc269485afda7ef0d89ecb0ac6b7f5"><td class="memItemLeft" align="right" valign="top"><a id="aeabc269485afda7ef0d89ecb0ac6b7f5"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#aeabc269485afda7ef0d89ecb0ac6b7f5">root</a> = &quot;../&quot;</td></tr>
<tr class="memdesc:aeabc269485afda7ef0d89ecb0ac6b7f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">directory from which to find the experiments sub-directory <br /></td></tr>
<tr class="separator:aeabc269485afda7ef0d89ecb0ac6b7f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b01f4fc126c644d07f906cd4e7f50fb"><td class="memItemLeft" align="right" valign="top"><a id="a8b01f4fc126c644d07f906cd4e7f50fb"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#a8b01f4fc126c644d07f906cd4e7f50fb">databaseFile</a> = 'ExperimentDatabase.csv'</td></tr>
<tr class="memdesc:a8b01f4fc126c644d07f906cd4e7f50fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">file with listing of known experiments <br /></td></tr>
<tr class="separator:a8b01f4fc126c644d07f906cd4e7f50fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79b1a3c6d50c8374eb4bb2bad5b524cc"><td class="memItemLeft" align="right" valign="top"><a id="a79b1a3c6d50c8374eb4bb2bad5b524cc"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#a79b1a3c6d50c8374eb4bb2bad5b524cc">experimentDirectory</a> = 'experiments/'</td></tr>
<tr class="memdesc:a79b1a3c6d50c8374eb4bb2bad5b524cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">directory containing experiment specifications and their output <br /></td></tr>
<tr class="separator:a79b1a3c6d50c8374eb4bb2bad5b524cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ada5eecb44f5b32c5ff5d38e545cc7e"><td class="memItemLeft" align="right" valign="top"><a id="a0ada5eecb44f5b32c5ff5d38e545cc7e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#a0ada5eecb44f5b32c5ff5d38e545cc7e">experiments</a> = pd.read_csv(root+experimentDirectory+databaseFile)</td></tr>
<tr class="memdesc:a0ada5eecb44f5b32c5ff5d38e545cc7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">read in the experiment database <br /></td></tr>
<tr class="separator:a0ada5eecb44f5b32c5ff5d38e545cc7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af409f14a4d0022ced8799cf11fbd490d"><td class="memItemLeft" align="right" valign="top"><a id="af409f14a4d0022ced8799cf11fbd490d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#af409f14a4d0022ced8799cf11fbd490d">expE</a> = experiments.index[experiments['Name']==experimentName]</td></tr>
<tr class="memdesc:af409f14a4d0022ced8799cf11fbd490d"><td class="mdescLeft">&#160;</td><td class="mdescRight">row of the experiment database giving the experiment to run <br /></td></tr>
<tr class="separator:af409f14a4d0022ced8799cf11fbd490d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd6f95f7722b094bc0e102f621e7324a"><td class="memItemLeft" align="right" valign="top"><a id="acd6f95f7722b094bc0e102f621e7324a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#acd6f95f7722b094bc0e102f621e7324a">experimentToRun</a> = expE[0]</td></tr>
<tr class="memdesc:acd6f95f7722b094bc0e102f621e7324a"><td class="mdescLeft">&#160;</td><td class="mdescRight">pick out the experiment <br /></td></tr>
<tr class="separator:acd6f95f7722b094bc0e102f621e7324a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46c20eb2a26abeb1e934cd66e1dd6484"><td class="memItemLeft" align="right" valign="top"><a id="a46c20eb2a26abeb1e934cd66e1dd6484"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#a46c20eb2a26abeb1e934cd66e1dd6484">path</a> = root+experiments['baseDirectory'][experimentToRun]</td></tr>
<tr class="memdesc:a46c20eb2a26abeb1e934cd66e1dd6484"><td class="mdescLeft">&#160;</td><td class="mdescRight">path to the directory for this experiment <br /></td></tr>
<tr class="separator:a46c20eb2a26abeb1e934cd66e1dd6484"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae38ab86af11d528ff512d0a8158f489"><td class="memItemLeft" align="right" valign="top"><a id="aae38ab86af11d528ff512d0a8158f489"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#aae38ab86af11d528ff512d0a8158f489">spec</a> = path+'/'+experiments['specificationFile'][experimentToRun]</td></tr>
<tr class="memdesc:aae38ab86af11d528ff512d0a8158f489"><td class="mdescLeft">&#160;</td><td class="mdescRight">file speciying experiment name and parameters <br /></td></tr>
<tr class="separator:aae38ab86af11d528ff512d0a8158f489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafc3cbf089d4b34918898333c6c39edc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#aafc3cbf089d4b34918898333c6c39edc">thisExperiment</a> = pd.read_csv(spec)</td></tr>
<tr class="memdesc:aafc3cbf089d4b34918898333c6c39edc"><td class="mdescLeft">&#160;</td><td class="mdescRight">read the specification file, which has the parameter sets and the name of the base parameter file.  <a href="runExperiment_8py.html#aafc3cbf089d4b34918898333c6c39edc">More...</a><br /></td></tr>
<tr class="separator:aafc3cbf089d4b34918898333c6c39edc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3385f07a3bfd79bb8f0dcabafb30c975"><td class="memItemLeft" align="right" valign="top"><a id="a3385f07a3bfd79bb8f0dcabafb30c975"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#a3385f07a3bfd79bb8f0dcabafb30c975">baseParameterFile</a> = path+'/'+thisExperiment['baseParameterFile'][0]</td></tr>
<tr class="memdesc:a3385f07a3bfd79bb8f0dcabafb30c975"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the parameter file name <br /></td></tr>
<tr class="separator:a3385f07a3bfd79bb8f0dcabafb30c975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad827090038061f4a04a789ab61df8c1d"><td class="memItemLeft" align="right" valign="top"><a id="ad827090038061f4a04a789ab61df8c1d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#ad827090038061f4a04a789ab61df8c1d">parameters</a> = reader.readlines()</td></tr>
<tr class="memdesc:ad827090038061f4a04a789ab61df8c1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">list of parameters <br /></td></tr>
<tr class="separator:ad827090038061f4a04a789ab61df8c1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74742cb5c8e2ac354a60cb73383d8176"><td class="memItemLeft" align="right" valign="top"><a id="a74742cb5c8e2ac354a60cb73383d8176"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#a74742cb5c8e2ac354a60cb73383d8176">rows</a> = thisExperiment.shape[0]</td></tr>
<tr class="memdesc:a74742cb5c8e2ac354a60cb73383d8176"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the number of columns <br /></td></tr>
<tr class="separator:a74742cb5c8e2ac354a60cb73383d8176"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaed057ed424ced7429016ec18c2edbb6"><td class="memItemLeft" align="right" valign="top"><a id="aaed057ed424ced7429016ec18c2edbb6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#aaed057ed424ced7429016ec18c2edbb6">cols</a> = thisExperiment.shape[1]</td></tr>
<tr class="memdesc:aaed057ed424ced7429016ec18c2edbb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">and rows for the parameters <br /></td></tr>
<tr class="separator:aaed057ed424ced7429016ec18c2edbb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51f20d6b1b54a2eee3be0e8adc96a0ae"><td class="memItemLeft" align="right" valign="top"><a id="a51f20d6b1b54a2eee3be0e8adc96a0ae"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#a51f20d6b1b54a2eee3be0e8adc96a0ae">param</a> = thisExperiment.columns[m+2]</td></tr>
<tr class="memdesc:a51f20d6b1b54a2eee3be0e8adc96a0ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the parameter name <br /></td></tr>
<tr class="separator:a51f20d6b1b54a2eee3be0e8adc96a0ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa616161d9dc4e64e4f2aa808cbab0cac"><td class="memItemLeft" align="right" valign="top"><a id="aa616161d9dc4e64e4f2aa808cbab0cac"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#aa616161d9dc4e64e4f2aa808cbab0cac">newValue</a> = str(thisExperiment.loc[parameterSet,param])</td></tr>
<tr class="memdesc:aa616161d9dc4e64e4f2aa808cbab0cac"><td class="mdescLeft">&#160;</td><td class="mdescRight">make sure the new value is a string <br /></td></tr>
<tr class="separator:aa616161d9dc4e64e4f2aa808cbab0cac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdc24ca189ea1f66dfd9245b4c970d59"><td class="memItemLeft" align="right" valign="top"><a id="afdc24ca189ea1f66dfd9245b4c970d59"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runExperiment_8py.html#afdc24ca189ea1f66dfd9245b4c970d59">now</a> = datetime.now().strftime(&quot;%d-%m-%Y_%H:%M:%S&quot;)</td></tr>
<tr class="memdesc:afdc24ca189ea1f66dfd9245b4c970d59"><td class="mdescLeft">&#160;</td><td class="mdescRight">format a current time string <br /></td></tr>
<tr class="separator:afdc24ca189ea1f66dfd9245b4c970d59"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Use csv files to define sets of values to be used in an experiment. </p>
<p>Read in the file that lists all the experiments, then select one experiment to run, and use the base model parameter file as specified for the experiment to write out a set of parameter files to cover the parameter space. The expectation is that all parameters to be changed will be given in the header row of the experiment specification file, starting at column 2 (columns 0 and 1 reserved for experiment name and parameter file name), with one row for every parameter set to be used (every parameter to be changed must have an entry in every row). This script can either directly run the model now (given the name of an executable), or else store parameter files for later (useful for hpc, for example). Note that all the paths for the experiment to be run need to be set up ahead of time, consistent with the base parameter file. </p><dl class="section author"><dt>Author</dt><dd>: Mike Bithell Created on Tue Sep 7 16:23:44 2021 </dd></dl>

<p class="definition">Definition in file <a class="el" href="runExperiment_8py_source.html">runExperiment.py</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="file_ad8918e03878b1f3c373ab776b2e22605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_ad8918e03878b1f3c373ab776b2e22605">&#9670;&nbsp;</a></span>change()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def runExperiment.change </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>new</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">function find and change a given parameter
</pre> 
<p class="definition">Definition at line <a class="el" href="runExperiment_8py_source.html#l00066">66</a> of file <a class="el" href="runExperiment_8py_source.html">runExperiment.py</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="file_aafc3cbf089d4b34918898333c6c39edc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_aafc3cbf089d4b34918898333c6c39edc">&#9670;&nbsp;</a></span>thisExperiment</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">thisExperiment = pd.read_csv(spec)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read the specification file, which has the parameter sets and the name of the base parameter file. </p>
<p>which will be modified for runs </p>

<p class="definition">Definition at line <a class="el" href="runExperiment_8py_source.html#l00055">55</a> of file <a class="el" href="runExperiment_8py_source.html">runExperiment.py</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
